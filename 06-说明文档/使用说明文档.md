# 综合布线记录管理系统 - 使用说明文档

## 目录

- [1. 系统概述](#1-系统概述)
- [2. 功能介绍](#2-功能介绍)
- [3. 技术架构](#3-技术架构)
- [4. 使用指南](#4-使用指南)
- [5. 部署说明](#5-部署说明)
- [6. 常见问题](#6-常见问题)

---

## 1. 系统概述

### 1.1 系统简介

综合布线记录管理系统是一个用于记录和管理各个机房综合布线信息的Web应用系统。系统支持多种格式的文件上传和自动识别，提供便捷的数据查询和下载功能，帮助运维工程师高效管理布线信息。

### 1.2 系统特点

- **多机房统一管理**：支持临港机房、金桥机房、国定机房、唐镇机房等多个机房的数据统一管理
- **灵活查询功能**：支持按机房、关键字、多条件组合查询，快速定位所需信息
- **文件自动识别**：支持上传Excel文件，自动解析并提取布线记录数据
- **用户友好界面**：基于Vue 3开发的现代化界面，操作简洁直观
- **数据安全可靠**：所有数据存储在SQLite数据库中，支持数据备份和恢复

### 1.3 适用场景

- 机房布线信息记录和管理
- 布线记录查询和检索
- 布线数据统计和分析
- 布线信息导出和分享

### 1.4 预期用户

| 用户角色 | 职责 |
|----------|------|
| 系统管理员 | 管理用户、配置系统、查看日志 |
| 运维工程师 | 录入、查询、管理布线信息 |
| 技术经理 | 查看统计报表、审批布线变更 |

---

## 2. 功能介绍

### 2.1 数据录入

#### 2.1.1 文件上传

系统支持上传Excel格式的布线记录文件，自动解析文件内容并提取数据。

**支持的文件格式**：
- Excel表格（.xlsx, .xls）

**上传方式**：
- 单文件上传：点击上传按钮选择单个文件
- 拖拽上传：将文件拖拽到上传区域

**文件要求**：
- 文件大小不超过50MB
- 文件格式符合系统模板要求

#### 2.1.2 自动解析

上传文件后，系统会自动解析Excel表格内容，提取以下字段：

| 字段名称 | 说明 |
|----------|------|
| 登记表编号 | 系统自动生成 |
| 机房名称 | 机房名称（如：临港机房、金桥机房等） |
| IDC需求编号 | IDC需求编号 |
| YES工单编号 | YES工单编号 |
| 用户单位 | 用户单位名称 |
| 线缆类型 | 单模光纤、多模光纤、网线 |
| 运营商 | OCN、电信、移动、联通 |
| 线路编号 | 线路编号 |
| 报障人/联系方式 | 报障联系人及电话 |
| 起始端口 | A端端口信息 |
| 一跳 | 中间跳接信息（一跳） |
| 二跳 | 中间跳接信息（二跳） |
| 三跳 | 中间跳接信息（三跳） |
| 四跳 | 中间跳接信息（四跳） |
| 五跳 | 中间跳接信息（五跳） |
| 目标端口 | Z端端口信息 |
| 用户机柜 | 用户机柜信息 |
| 线路标签是否齐全 | 是/否 |
| 线路是否规范 | 是/否 |
| 备注 | 备注信息 |

### 2.2 查询检索

#### 2.2.1 机房筛选

系统支持按机房筛选布线记录，可以选择一个或多个机房进行查询。

**支持的机房**：
- 临港机房
- 金桥机房
- 国定机房
- 唐镇机房
- 美盛机房
- 通联机房
- 深圳云引擎机房

**操作方式**：
- 点击机房标签快速添加/移除筛选条件
- 点击"添加机房"按钮展开机房选择面板
- 点击"清除筛选"清空所有机房筛选条件

#### 2.2.2 关键字查询

系统支持关键字模糊查询，可查询以下字段：

- 登记表编号
- IDC需求编号
- YES工单编号
- 用户单位
- 线路编号
- A端（起始端口）
- Z端（目标端口）
- 用户机柜
- 运营商
- 线缆类型

**操作方式**：
- 在关键字输入框中输入查询内容
- 按回车键或点击"查询"按钮执行查询
- 点击"清空"按钮清空查询条件

#### 2.2.3 精确筛选

系统支持按以下条件进行精确筛选：

- **线缆类型**：全部、单模光纤、多模光纤、网线
- **运营商**：全部、OCN、电信、移动、联通
- **标签齐全**：全部、是、否
- **线路规范**：全部、是、否

**操作方式**：
- 点击下拉框展开选项
- 选择选项后自动刷新查询结果

#### 2.2.4 组合查询

系统支持多个条件组合查询，可以同时使用机房筛选、关键字查询和精确筛选。

**操作方式**：
- 选择机房筛选（可选）
- 输入关键字查询（可选）
- 选择精确筛选条件（可选）
- 点击"查询"按钮执行查询

### 2.3 数据展示

#### 2.3.1 列表视图

系统以表格形式展示布线记录列表，显示以下信息：

| 列名 | 说明 |
|------|------|
| 编号 | 登记表编号 |
| 机房名称 | 机房名称 |
| 用户单位 | 用户单位名称 |
| 线路编号 | 线路编号 |
| A端 | 起始端口信息 |
| Z端 | 目标端口信息 |
| 状态 | 线路状态（正常/警告） |
| 操作 | 操作按钮（详情） |

**列表功能**：
- 支持按任意列排序
- 支持分页浏览（每页20/50/100/200条）
- 鼠标悬停高亮当前行
- 点击"详情"按钮查看记录详细信息

#### 2.3.2 详情视图

点击记录的"详情"按钮，可以查看该记录的完整信息。

**详情信息**：
- 登记表编号
- 机房名称
- IDC需求编号
- YES工单编号
- 用户单位
- 线缆类型
- 运营商
- 线路编号
- 报障人/联系方式
- 起始端口
- 中间跳接信息（一跳、二跳、三跳、四跳、五跳）
- 目标端口
- 用户机柜
- 线路标签是否齐全
- 线路是否规范
- 备注
- 创建时间
- 更新时间

### 2.4 数据导出

系统支持将查询结果导出为Excel文件。

**导出方式**：
- 点击"导出结果"按钮
- 选择导出范围（当前页/全部）
- 下载Excel文件

---

## 3. 技术架构

### 3.1 技术栈

#### 3.1.1 前端技术栈

| 技术 | 版本 | 说明 |
|------|------|------|
| Vue | 3.x | 前端框架 |
| TypeScript | 5.x | 编程语言 |
| Element Plus | 2.x | UI组件库 |
| Vue Router | 4.x | 路由管理 |
| Axios | 1.x | HTTP请求 |
| Vite | 5.x | 构建工具 |

#### 3.1.2 后端技术栈

| 技术 | 版本 | 说明 |
|------|------|------|
| Node.js | 18.x | 运行环境 |
| TypeScript | 5.x | 编程语言 |
| Express | 4.x | Web框架 |
| better-sqlite3 | 9.x | SQLite数据库 |
| Multer | 1.x | 文件上传 |
| XLSX | 0.18.x | Excel解析 |
| CORS | 2.x | 跨域处理 |

#### 3.1.3 数据库

| 技术 | 版本 | 说明 |
|------|------|------|
| SQLite | 3.x | 关系型数据库 |

### 3.2 项目结构

```
综合布线记录管理系统/
├── backend/                    # 后端代码
│   ├── src/
│   │   ├── config/            # 配置文件
│   │   │   └── database.ts    # 数据库配置
│   │   ├── controllers/        # 控制器
│   │   │   ├── record.controller.ts
│   │   │   └── upload.controller.ts
│   │   ├── models/            # 数据模型
│   │   │   └── record.model.ts
│   │   ├── routes/            # 路由
│   │   │   ├── index.ts
│   │   │   ├── record.routes.ts
│   │   │   └── upload.routes.ts
│   │   ├── services/          # 业务逻辑
│   │   │   ├── record.service.ts
│   │   │   └── upload.service.ts
│   │   ├── utils/             # 工具函数
│   │   │   └── excel.parser.ts
│   │   ├── app.ts             # Express应用配置
│   │   └── server.ts          # 服务器入口
│   ├── uploads/               # 上传文件目录
│   ├── data/                  # 数据库文件目录
│   ├── package.json
│   ├── tsconfig.json
│   └── .env                  # 环境变量
├── frontend/                  # 前端代码
│   ├── src/
│   │   ├── assets/           # 静态资源
│   │   ├── components/       # 组件
│   │   │   ├── RecordList.vue
│   │   │   ├── UploadFile.vue
│   │   │   ├── ParseResult.vue
│   │   │   └── RecordDetail.vue
│   │   ├── router/           # 路由
│   │   │   └── index.ts
│   │   ├── services/         # API服务
│   │   │   └── api.ts
│   │   ├── types/            # TypeScript类型定义
│   │   │   └── index.ts
│   │   ├── utils/            # 工具函数
│   │   ├── App.vue
│   │   └── main.ts
│   ├── public/
│   ├── index.html
│   ├── package.json
│   ├── tsconfig.json
│   └── vite.config.ts
├── README.md
└── .gitignore
```

### 3.3 数据库设计

#### 3.3.1 records表

| 字段名 | 数据类型 | 说明 |
|--------|----------|------|
| id | INTEGER | 主键，自增 |
| record_number | TEXT | 登记表编号 |
| datacenter_name | TEXT | 机房名称 |
| idc_requirement_number | TEXT | IDC需求编号 |
| yes_ticket_number | TEXT | YES工单编号 |
| user_unit | TEXT | 用户单位 |
| cable_type | TEXT | 线缆类型 |
| operator | TEXT | 运营商 |
| circuit_number | TEXT | 线路编号 |
| contact_person | TEXT | 报障人/联系方式 |
| start_port | TEXT | 起始端口（A端） |
| hop1 | TEXT | 一跳 |
| hop2 | TEXT | 二跳 |
| hop3 | TEXT | 三跳 |
| hop4 | TEXT | 四跳 |
| hop5 | TEXT | 五跳 |
| end_port | TEXT | 目标端口（Z端） |
| user_cabinet | TEXT | 用户机柜 |
| label_complete | INTEGER | 线路标签是否齐全（0:否, 1:是） |
| cable_standard | INTEGER | 线路是否规范（0:否, 1:是） |
| remark | TEXT | 备注 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |

#### 3.3.2 索引

| 索引名 | 字段 | 说明 |
|--------|------|------|
| idx_datacenter_name | datacenter_name | 机房名称索引 |
| idx_record_number | record_number | 登记表编号索引 |
| idx_circuit_number | circuit_number | 线路编号索引 |
| idx_start_port | start_port | 起始端口索引 |
| idx_end_port | end_port | 目标端口索引 |
| idx_user_cabinet | user_cabinet | 用户机柜索引 |
| idx_operator | operator | 运营商索引 |
| idx_cable_type | cable_type | 线缆类型索引 |

### 3.4 API接口设计

#### 3.4.1 获取记录列表

**接口**：`GET /api/records`

**参数**：
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | Number | 否 | 页码（默认1） |
| pageSize | Number | 否 | 每页数量（默认50） |
| datacenterNames | Array | 否 | 机房名称数组 |
| keyword | String | 否 | 关键字 |
| cableType | String | 否 | 线缆类型 |
| operator | String | 否 | 运营商 |
| labelComplete | Number | 否 | 标签齐全 |
| cableStandard | Number | 否 | 线路规范 |

**返回**：
```json
{
  "success": true,
  "data": {
    "records": [
      {
        "id": 1,
        "recordNumber": "WL-001",
        "datacenterName": "临港机房",
        "userUnit": "东方有线",
        "circuitNumber": "4705764620ShH",
        "startPort": "丽正路老芦公路光交",
        "endPort": "101机房G01"
      }
    ],
    "total": 156,
    "page": 1,
    "pageSize": 50
  }
}
```

#### 3.4.2 获取记录详情

**接口**：`GET /api/records/:id`

**参数**：
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | Number | 是 | 记录ID |

**返回**：
```json
{
  "success": true,
  "data": {
    "id": 1,
    "recordNumber": "WL-001",
    "datacenterName": "临港机房",
    "idcRequirementNumber": "RWD-20250805-065",
    "yesTicketNumber": "QTJF-202508-2354",
    "userUnit": "东方有线",
    "cableType": "单模光纤",
    "operator": "OCN",
    "circuitNumber": "4705764620ShH",
    "contactPerson": "400-884-1883",
    "startPort": "丽正路老芦公路光交",
    "hop1": "接入间A-A01-ODF3-1/2",
    "hop2": "接入间A-A04-ODF3-1#1/2",
    "hop3": "-",
    "hop4": "-",
    "hop5": "-",
    "endPort": "101机房G01",
    "userCabinet": "-",
    "labelComplete": 1,
    "cableStandard": 1,
    "remark": "-",
    "createdAt": "2025-12-24 10:30:00"
  }
}
```

#### 3.4.3 上传文件

**接口**：`POST /api/upload`

**参数**：
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| file | File | 是 | Excel文件 |

**返回**：
```json
{
  "success": true,
  "data": {
    "fileId": "1234567890",
    "fileName": "临港机房布线记录.xlsx",
    "recordCount": 25
  }
}
```

#### 3.4.4 解析文件

**接口**：`POST /api/parse`

**参数**：
```json
{
  "fileId": "1234567890"
}
```

**返回**：
```json
{
  "success": true,
  "data": {
    "records": [
      {
        "datacenterName": "临港机房",
        "userUnit": "东方有线",
        "circuitNumber": "4705764620",
        "startPort": "丽正路...",
        "endPort": "101机房"
      }
    ],
    "total": 25
  }
}
```

#### 3.4.5 保存记录

**接口**：`POST /api/records`

**参数**：
```json
{
  "fileId": "1234567890",
  "records": [
    {
      "datacenterName": "临港机房",
      "userUnit": "东方有线",
      "circuitNumber": "4705764620",
      "startPort": "丽正路...",
      "endPort": "101机房"
    }
  ]
}
```

**返回**：
```json
{
  "success": true,
  "data": {
    "savedCount": 25
  }
}
```

---

## 4. 使用指南

### 4.1 系统登录

1. 打开浏览器，访问系统地址
2. 输入用户名和密码
3. 点击"登录"按钮
4. 登录成功后进入系统首页

### 4.2 上传布线记录文件

1. 点击右上角的"上传文件"按钮
2. 选择要上传的Excel文件
3. 等待文件上传完成
4. 系统自动解析文件内容
5. 查看解析结果
6. 确认无误后保存到数据库

### 4.3 查询布线记录

#### 4.3.1 按机房查询

1. 在查询条件区的"机房"区域，点击要查询的机房标签
2. 可以选择多个机房
3. 点击"查询"按钮
4. 查看查询结果

#### 4.3.2 关键字查询

1. 在关键字输入框中输入查询内容
2. 按回车键或点击"查询"按钮
3. 查看查询结果

#### 4.3.3 精确筛选

1. 点击下拉框展开选项
2. 选择筛选条件
3. 点击"查询"按钮
4. 查看查询结果

#### 4.3.4 组合查询

1. 选择机房筛选（可选）
2. 输入关键字查询（可选）
3. 选择精确筛选条件（可选）
4. 点击"查询"按钮
5. 查看查询结果

### 4.4 查看记录详情

1. 在布线记录列表中找到要查看的记录
2. 点击该记录的"详情"按钮
3. 查看记录的完整信息
4. 点击"返回列表"返回列表页

### 4.5 导出查询结果

1. 执行查询操作
2. 点击"导出结果"按钮
3. 选择导出范围（当前页/全部）
4. 下载Excel文件

### 4.6 快捷键

| 快捷键 | 功能 |
|--------|------|
| Enter | 执行查询 |
| Esc | 清空查询条件 |
| Ctrl+F | 聚焦搜索框 |

---

## 5. 部署说明

### 5.1 环境要求

#### 5.1.1 服务器要求

- 操作系统：Linux（推荐Ubuntu 20.04+）或Windows Server
- CPU：2核及以上
- 内存：4GB及以上
- 硬盘：20GB及以上

#### 5.1.2 软件要求

- Node.js：18.x及以上
- npm：9.x及以上
- Git：2.x及以上

### 5.2 本地开发

#### 5.2.1 克隆项目

```bash
git clone <项目地址>
cd 综合布线记录管理系统
```

#### 5.2.2 安装后端依赖

```bash
cd backend
npm install
```

#### 5.2.3 配置环境变量

创建`.env`文件：

```env
PORT=3000
NODE_ENV=development
```

#### 5.2.4 启动后端服务

```bash
npm run dev
```

后端服务将在`http://localhost:3000`启动。

#### 5.2.5 安装前端依赖

```bash
cd frontend
npm install
```

#### 5.2.6 配置API地址

修改`src/services/api.ts`中的API地址：

```typescript
const API_BASE_URL = 'http://localhost:3000/api';
```

#### 5.2.7 启动前端服务

```bash
npm run dev
```

前端服务将在`http://localhost:5173`启动。

#### 5.2.8 访问系统

打开浏览器，访问`http://localhost:5173`。

### 5.3 生产部署

#### 5.3.1 构建前端

```bash
cd frontend
npm run build
```

构建完成后，`dist`目录包含打包后的文件。

#### 5.3.2 配置后端静态文件服务

修改`backend/src/app.ts`，配置静态文件服务：

```typescript
app.use(express.static(path.join(__dirname, '../frontend/dist')));
```

#### 5.3.3 启动后端服务

```bash
cd backend
npm start
```

#### 5.3.4 使用PM2管理进程

```bash
npm install -g pm2
pm2 start backend/dist/server.js --name sjzx-server
pm2 save
pm2 startup
```

#### 5.3.5 配置Nginx反向代理

创建Nginx配置文件：

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

重启Nginx：

```bash
sudo nginx -t
sudo systemctl restart nginx
```

### 5.4 数据备份

#### 5.4.1 备份数据库

```bash
cp backend/data/database.sqlite backend/data/database.sqlite.backup
```

#### 5.4.2 定期备份

使用cron定时任务定期备份数据库：

```bash
crontab -e
```

添加以下内容（每天凌晨2点备份）：

```
0 2 * * * cp /path/to/backend/data/database.sqlite /path/to/backup/database_$(date +\%Y\%m\%d).sqlite
```

---

## 6. 常见问题

### 6.1 上传文件失败

**问题**：上传Excel文件时提示失败

**解决方案**：
1. 检查文件格式是否正确（.xlsx或.xls）
2. 检查文件大小是否超过50MB
3. 检查网络连接是否正常
4. 查看浏览器控制台错误信息

### 6.2 解析文件失败

**问题**：上传文件后解析失败

**解决方案**：
1. 检查Excel文件是否符合系统模板要求
2. 检查Excel文件的列名是否正确
3. 检查Excel文件是否包含必要的数据
4. 查看后端日志获取详细错误信息

### 6.3 查询结果为空

**问题**：执行查询后没有结果显示

**解决方案**：
1. 检查查询条件是否正确
2. 检查数据库中是否有符合条件的数据
3. 尝试清空查询条件，查看所有数据
4. 检查数据库连接是否正常

### 6.4 系统访问慢

**问题**：系统响应速度慢

**解决方案**：
1. 检查网络连接是否正常
2. 检查服务器资源使用情况（CPU、内存）
3. 检查数据库查询是否优化
4. 考虑增加服务器资源

### 6.5 数据丢失

**问题**：数据库中的数据丢失

**解决方案**：
1. 检查是否有备份文件
2. 从备份文件恢复数据
3. 检查系统日志，查找数据丢失原因
4. 联系系统管理员

### 6.6 无法登录

**问题**：输入正确的用户名和密码后无法登录

**解决方案**：
1. 检查用户名和密码是否正确
2. 检查用户账号是否被禁用
3. 清除浏览器缓存和Cookie
4. 联系系统管理员重置密码

---

## 附录

### A. 数据字典

#### A.1 机房列表

- 临港机房
- 金桥机房
- 国定机房
- 唐镇机房
- 美盛机房
- 通联机房
- 深圳云引擎机房

#### A.2 线缆类型

- 单模光纤
- 多模光纤
- 网线

#### A.3 运营商

- OCN
- 电信
- 移动
- 联通

#### A.4 线路状态

- 正常
- 警告

### B. 联系方式

如有问题或建议，请联系系统管理员。

---

*文档版本：v1.0*
*最后更新：2025-12-24*
